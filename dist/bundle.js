(()=>{var e={774:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function o(e,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,a=function(e,o){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===t(a)?a:String(a)),n)}var a}var r=function(){function e(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.prefix="[LogIndexedDBSDK] :",this.databaseName=t,this.objectStoreName=o,this.db=null}var t,r;return t=e,(r=[{key:"openDatabase",value:function(){var e=this;return new Promise((function(t,o){var r=window.indexedDB.open(e.databaseName);r.onerror=function(t){console.error("".concat(e.prefix," Failed to open database: ").concat(t.target.error)),o(t.target.error)},r.onsuccess=function(o){e.db=o.target.result,console.log("".concat(e.prefix," Open database ").concat(e.databaseName," successfully.")),t()},r.onupgradeneeded=function(t){var o=t.target.result;if(!o.objectStoreNames.contains(e.objectStoreName)){var r=o.createObjectStore(e.objectStoreName,{keyPath:"id",autoIncrement:!0});r.createIndex("byId","id",{unique:!0}),r.createIndex("byTimestamp","timestamp"),r.createIndex("byModule","module"),r.createIndex("byUserId","userId"),r.createIndex("byClientId","clientId")}}}))}},{key:"executeQuery",value:function(e,t,o){var r=this;e.onsuccess=function(e){t&&t(e.target.result)},e.onerror=function(e){console.error("".concat(r.prefix," Error executing query: ").concat(e.target.error)),o&&o(e.target.error)}}},{key:"createTransaction",value:function(e){return this.db.transaction(this.objectStoreName,e).objectStore(this.objectStoreName)}},{key:"createTable",value:function(e,t){var o=this;return new Promise((function(r,n){o.openDatabase().then((function(){r(),e&&e()})).catch((function(e){n(e),t&&t(e)}))}))}},{key:"insertData",value:function(e,t,o){var r=this;return new Promise((function(n,a){var i=r.createTransaction("readwrite").add(e);r.executeQuery(i,(function(){console.log("".concat(r.prefix," Data inserted successfully.")),n(),t&&t()}),(function(e){a(e),o&&o(e)}))}))}},{key:"selectData",value:function(e,t,o){var r=this;return new Promise((function(n,a){var i=r.createTransaction("readonly"),c=[],u=i.openCursor();u.onsuccess=function(o){var a=o.target.result;if(a){var i=a.value;e.module&&i.module!==e.module||e.level&&i.level!==e.level||e.userId&&i.userId!==e.userId||e.clientId&&i.clientId!==e.clientId||c.push(i),a.continue()}else console.log("".concat(r.prefix," Selected data:"),c),n(c),t&&t(c)},u.onerror=function(e){a(e.target.error),o&&o(e.target.error)}}))}},{key:"updateData",value:function(e,t,o,r){var n=this;return new Promise((function(a,i){var c=n.createTransaction("readwrite").openCursor(IDBKeyRange.only(e));c.onsuccess=function(e){var c=e.target.result;if(c){var u=c.update(t);n.executeQuery(u,(function(){console.log("".concat(n.prefix," Data updated successfully.")),a(),o&&o()}),(function(e){i(e),r&&r(e)}))}else console.log("".concat(n.prefix," No data found for update.")),a(),o&&o()},c.onerror=function(e){i(e.target.error),r&&r(e.target.error)}}))}},{key:"deleteData",value:function(e,t,o){var r=this;return new Promise((function(n,a){var i=r.createTransaction("readwrite").openCursor(IDBKeyRange.only(e));i.onsuccess=function(e){var i=e.target.result;if(i){var c=i.delete();r.executeQuery(c,(function(){console.log("".concat(r.prefix," Data deleted successfully.")),n(),t&&t()}),(function(e){a(e),o&&o(e)}))}else console.log("".concat(r.prefix," No data found for delete.")),n(),t&&t()},i.onerror=function(e){a(e.target.error),o&&o(e.target.error)}}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=r},352:(e,t,o)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,a=function(e,t){if("object"!==r(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===r(a)?a:String(a)),n)}var a}function i(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var c=o(774),u=o(648),l=function(){function e(t){var o=t.moduleName,r=t.Logger;n(this,e),this.moduleName=o,this.Logger=r}return i(e,[{key:"info",value:function(e){console.log("[Info] [".concat(this.moduleName,"] ").concat(e)),this.Logger(this.moduleName,"Info",e)}},{key:"warn",value:function(e){console.log("[Warn] [".concat(this.moduleName,"] ").concat(e)),this.Logger(this.moduleName,"Warn",e)}}]),e}(),s=function(){function e(t){n(this,e);var o=t.CollectionName,r=void 0===o?"logs":o,a=t.DatabaseName,i=void 0===a?"MyDatabase":a,c=t.ObjectStoreName,u=void 0===c?"logs":c,l=t.UserId,s=void 0===l?"UNKNOWN":l,f=t.ClientId,d=void 0===f?"UNKNOWN":f,y=t.Modules,g=void 0===y?[]:y;this.CollectionName=r,this.DatabaseName=i,this.ObjectStoreName=u,this.UserId=s,this.ClientId=d,console.log(this.ClientId),this.prefix="[LogSystem] : ",console.log("".concat(this.prefix,"Logger initialized.")),this.connect(),this.initModules(g)}return i(e,[{key:"connect",value:function(){var e=this;this.dbClient=new c(this.DatabaseName,this.ObjectStoreName),this.dbClient.openDatabase().then((function(){console.log("".concat(e.prefix,"Connected to IndexedDB.")),e.createTable()})).catch((function(t){console.error("".concat(e.prefix,"Error connecting to IndexedDB:"),t)}))}},{key:"initModules",value:function(e){var t=this;e.forEach((function(e){t[e]=new l({moduleName:e,Logger:t.logger.bind(t)})}))}},{key:"createTable",value:function(){var e=this;this.dbClient.createTable().then((function(){console.log("".concat(e.prefix,"Logs table created successfully."))})).catch((function(t){console.error("".concat(e.prefix,"Error creating logs table:"),t)}))}},{key:"logger",value:function(e,t,o){var r=this,n={userId:this.UserId,clientId:this.ClientId,module:e,level:t,timestamp:u.getFormattedDate(),message:o,isUpload:!1,data:{key:"value"}};this.dbClient.insertData(n).then((function(){console.log("".concat(r.prefix,"Log inserted successfully."))})).catch((function(e){console.error("".concat(r.prefix,"Error inserting log:"),e)}))}},{key:"getLogs",value:function(e,t,o){this.dbClient.selectData({userId:"Huangliang"},t,o).then((function(e){console.log("Retrieved logs:",e)})).catch((function(e){console.error("Error getting logs:",e)}))}}]),e}();window.Logger=s,e.exports=s},648:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function o(e,o){for(var r=0;r<o.length;r++){var n=o[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,a=function(e,o){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===t(a)?a:String(a)),n)}var a}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"getFormattedDate",value:function(){var e=new Date,t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0"),c=String(e.getMilliseconds()).padStart(3,"0");return"".concat(t,"-").concat(o,"-").concat(r," ").concat(n,":").concat(a,":").concat(i,".").concat(c)}},{key:"generateRandomString",value:function(e){for(var t="",o=0;o<e;o++){var r=Math.floor(62*Math.random());t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r)}return t}}],null&&o(t.prototype,null),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=r}},t={};!function o(r){var n=t[r];if(void 0!==n)return n.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,o),a.exports}(352)})();
//# sourceMappingURL=bundle.js.map